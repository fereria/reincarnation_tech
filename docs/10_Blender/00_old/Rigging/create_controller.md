# コントローラーを作成する

<!-- SUMMARY:コントローラーを作成する-->

Blender で RIG を作成する場合のコントローラを作履帯場合  
アーマチュアの BONE の見た目を変えることでコントローラー扱いにする。  
何故単独のオブジェクトにしないかというと、  
モデルを Link で読み込んだときに、アーマチュアの中にコントローラーがあれば  
アーマチュア 1 つを Proxy にすればよいから。

## 準備

![](https://gyazo.com/94223baba8592fce81e6f5cc22a5e22d.png)

まず、ジョイントを作成します。  
現在のジョイントの向きがわかるように Axis を表示しておきます。

![](https://gyazo.com/5d749b7a7ef1b1fa93c5d928e5ffc9b5.png)

コントローラーオブジェクトは、オブジェクトのスケールなどではなく  
頂点を移動して形状を作ります。  
（Maya 的に言えば FreezeTransform した状態）

そして、オブジェクトの原点位置がジョイント位置になり、  
軸もジョイントとコントローラーは同じ向きになる。

## コントローラーを指定する

実際にジョイントに対してコントローラーを指定していきます。

アーマチュアを **PoseMode** で選択し、オブジェクトの形状に置き換えたいジョイントを選択します。

![](https://gyazo.com/bac6fca45dd2b8ef08281b4d2c8b7225.png)

そして、Bone のなかの Display→CustomObject に、コントローラーにしたいメッシュを選択します。

![](https://gyazo.com/82f98da64b347ddf5f4edaa114dbe22b.png)

じっこうすると、ジョイントの軸にあわせてコントローラー用の Mesh オブジェクトが配置されます。  
そのままだとコントローラーっぽくないので  
「Wireframe」にチェックを入れれば  
ロケーターのように RIG っぽいコントローラーになります。

![](https://gyazo.com/6ca47b7fcd902f7be07f15d2bfb40f38.gif)

このコントローラーは、インスタンスになっているので  
コントローラー化したあとにメッシュを編集すると  
コントローラー側の形状も変わります。

コントローラーの位置のオフセットはできないですが、  
「Scale」を変更すると、大きの変更をすることができます。

## コントローラーの色を変える

コントローラーの色を変えるには JointGroup を使用します。

![](https://gyazo.com/0b0855cce84283c55050cf2714066cb4.png)

色を変えたいジョイントを BoneGroups に入れて、「Color」を指定します。

![](https://gyazo.com/5b744784178f516e13e27b0386678b9b.png)

指定すると、PoseMode 時は BoneGroup で指定した色がコントローラーの色になります。

![](https://gyazo.com/4f2aae75b3209d09d2432e3c00b60304.png)

Wireframe を外すと、SolidColor で塗りつぶされたコントローラーを作ることができます。

## 簡単なシーンを作ってみる

![](https://gyazo.com/b381e631f6d58a508641e499fdf56b1c.png)

以前 IK を作るテストでやったような、単純な IK コントローラーとポールベクター。  
以前は、個別のオブジェクトでコントローラーを作りましたが、

![](https://gyazo.com/293d24300c31f49d28d74342322bd9ab.png)

今回は、こんな感じで、メインになるアーマチュア内に RIG 用の Bone を作成し  
それをポールベクターターゲットにしました。

![](https://gyazo.com/07fb5c37701228e365a5a55b46d4235e.png)

こんな感じで、Bone のアーマチュアを選択 →Bone を選択　のようにすれば  
Bone でもターゲット扱いにできます。

需要があるかは謎ですが、サンプルシーンをアップしました。

[テストで作成した Blend シーン](https://remi-saba.net:5001/d/f/469945308602704033)

## おまけ

Maya の感覚だと、１ Blend ファイル＝１ MayaScene の感覚になるけれども  
その感覚を取り払って、  
どのレイヤーも（Blend、Scene、Object など）Maya のシーン１つと同じ扱いに  
できると考えるとしっくりくるかも。

今回の場合は、アーマチュアの中身自体が１つの Maya シーンのような構成。  
Maya シーン的なシーン（パーツ）が寄せ集まって Link する構成が  
Blender なのかもしれない？
